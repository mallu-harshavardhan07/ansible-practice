- name: redis microservice
  hosts: redishost
  become: true
  tasks:
  - name: disable redis 6
    ansible.builtin.command: dnf module disable redis -y
  - name: enable redis 7
    ansible.builtin.command: dnf module enable redis:7 -y
  - name : installing redis version 7
    ansible.builtin.package:
        name: redis
        state: present
  - name: opening redis port to everyone 
    ansible.builtin.replace:
        path: /etc/redis/redis.conf
        regex: '127.0.0.1'
        replace: '0.0.0.0'
  - name: updating value of protected mode from YES to NO
    ansible.builtin.replace:
        path: etc/redis/redis.conf
        regex: 'yes'
        replace: 'no'
  - name: enabling the redis server and starting it
    ansible.builtin.service:
        name: redis
        state: started
        enabled: yes
